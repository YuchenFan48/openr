2025-05-15 12:29:29 | INFO | reward_model_worker | args: Namespace(host='0.0.0.0', port=30012, worker_address='http://0.0.0.0:30012', controller_address='http://0.0.0.0:28777', model_path='/fs-computility/mabasic/shared/models/reward_model/Qwen2.5-Math-PRM-7B', revision='main', device='cuda', gpus=None, num_gpus=1, max_gpu_memory=None, dtype=None, load_8bit=False, cpu_offloading=False, gptq_ckpt=None, gptq_wbits=16, gptq_groupsize=-1, gptq_act_order=False, awq_ckpt=None, awq_wbits=16, awq_groupsize=-1, enable_exllama=False, exllama_max_seq_len=4096, exllama_gpu_split=None, exllama_cache_8bit=False, enable_xft=False, xft_max_seq_len=4096, xft_dtype=None, model_names=None, conv_template=None, embed_in_truncate=False, limit_worker_concurrency=5, stream_interval=2, no_register=False, seed=None, debug=False, ssl=False)
2025-05-15 12:29:29 | INFO | reward_model_worker | Loading the model ['Qwen2.5-Math-PRM-7B'] on worker dfd19636 ...
2025-05-15 12:29:29 | ERROR | stderr | Loading checkpoint shards:   0%|                                                  | 0/4 [00:00<?, ?it/s]
2025-05-15 12:29:33 | ERROR | stderr | Loading checkpoint shards:  25%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ                               | 1/4 [00:03<00:11,  3.83s/it]
2025-05-15 12:29:38 | ERROR | stderr | Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                     | 2/4 [00:08<00:09,  4.61s/it]
2025-05-15 12:29:42 | ERROR | stderr | Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ          | 3/4 [00:13<00:04,  4.46s/it]
2025-05-15 12:29:45 | ERROR | stderr | Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.72s/it]
2025-05-15 12:29:45 | ERROR | stderr | Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.96s/it]
2025-05-15 12:29:45 | ERROR | stderr | 
2025-05-15 12:29:48 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m719628[0m]
2025-05-15 12:29:48 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2025-05-15 12:29:48 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2025-05-15 12:29:48 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://0.0.0.0:30012[0m (Press CTRL+C to quit)
2025-05-15 12:30:22 | INFO | stdout | [32mINFO[0m:     127.0.0.1:35594 - "[1mPOST /worker_value_inference HTTP/1.1[0m" [91m500 Internal Server Error[0m
2025-05-15 12:30:22 | ERROR | stderr | [31mERROR[0m:    Exception in ASGI application
2025-05-15 12:30:22 | ERROR | stderr | Traceback (most recent call last):
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
2025-05-15 12:30:22 | ERROR | stderr |     result = await app(  # type: ignore[func-returns-value]
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     return await self.app(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     await super().__call__(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     raise exc
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     await self.app(scope, receive, _send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:30:22 | ERROR | stderr |     raise exc
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:30:22 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
2025-05-15 12:30:22 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
2025-05-15 12:30:22 | ERROR | stderr |     await route.handle(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
2025-05-15 12:30:22 | ERROR | stderr |     await self.app(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
2025-05-15 12:30:22 | ERROR | stderr |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:30:22 | ERROR | stderr |     raise exc
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:30:22 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
2025-05-15 12:30:22 | ERROR | stderr |     response = await f(request)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
2025-05-15 12:30:22 | ERROR | stderr |     raw_response = await run_endpoint_function(
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
2025-05-15 12:30:22 | ERROR | stderr |     return await dependant.call(**values)
2025-05-15 12:30:22 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/base_model_worker.py", line 218, in value_inference
2025-05-15 12:30:22 | ERROR | stderr |     output = await asyncio.to_thread(worker.value_inference_gate, params)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/asyncio/threads.py", line 25, in to_thread
2025-05-15 12:30:22 | ERROR | stderr |     return await loop.run_in_executor(None, func_call)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/concurrent/futures/thread.py", line 58, in run
2025-05-15 12:30:22 | ERROR | stderr |     result = self.fn(*self.args, **self.kwargs)
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:30:22 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:30:22 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in value_inference_gate
2025-05-15 12:30:22 | ERROR | stderr |     value = [self.infer_fn(s).tolist() for s in input_str]
2025-05-15 12:30:22 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in <listcomp>
2025-05-15 12:30:22 | ERROR | stderr |     value = [self.infer_fn(s).tolist() for s in input_str]
2025-05-15 12:30:22 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:30:22 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:30:22 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/prm/infer_fns.py", line 16, in _qwen_math_infer_fn
2025-05-15 12:30:22 | ERROR | stderr |     scores = logits.softmax(dim=-1)[:,:,0]
2025-05-15 12:30:22 | ERROR | stderr | RuntimeError: CUDA error: device-side assert triggered
2025-05-15 12:30:22 | ERROR | stderr | CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
2025-05-15 12:30:22 | ERROR | stderr | For debugging consider passing CUDA_LAUNCH_BLOCKING=1
2025-05-15 12:30:22 | ERROR | stderr | Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
2025-05-15 12:30:22 | ERROR | stderr | 
2025-05-15 12:30:24 | INFO | stdout | [32mINFO[0m:     127.0.0.1:35598 - "[1mPOST /worker_value_inference HTTP/1.1[0m" [91m500 Internal Server Error[0m
2025-05-15 12:30:24 | ERROR | stderr | [31mERROR[0m:    Exception in ASGI application
2025-05-15 12:30:24 | ERROR | stderr | Traceback (most recent call last):
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
2025-05-15 12:30:24 | ERROR | stderr |     result = await app(  # type: ignore[func-returns-value]
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     return await self.app(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     await super().__call__(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     raise exc
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     await self.app(scope, receive, _send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:30:24 | ERROR | stderr |     raise exc
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:30:24 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
2025-05-15 12:30:24 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
2025-05-15 12:30:24 | ERROR | stderr |     await route.handle(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
2025-05-15 12:30:24 | ERROR | stderr |     await self.app(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
2025-05-15 12:30:24 | ERROR | stderr |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:30:24 | ERROR | stderr |     raise exc
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:30:24 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
2025-05-15 12:30:24 | ERROR | stderr |     response = await f(request)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
2025-05-15 12:30:24 | ERROR | stderr |     raw_response = await run_endpoint_function(
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
2025-05-15 12:30:24 | ERROR | stderr |     return await dependant.call(**values)
2025-05-15 12:30:24 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/base_model_worker.py", line 218, in value_inference
2025-05-15 12:30:24 | ERROR | stderr |     output = await asyncio.to_thread(worker.value_inference_gate, params)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/asyncio/threads.py", line 25, in to_thread
2025-05-15 12:30:24 | ERROR | stderr |     return await loop.run_in_executor(None, func_call)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/concurrent/futures/thread.py", line 58, in run
2025-05-15 12:30:24 | ERROR | stderr |     result = self.fn(*self.args, **self.kwargs)
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:30:24 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:30:24 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in value_inference_gate
2025-05-15 12:30:24 | ERROR | stderr |     value = [self.infer_fn(s).tolist() for s in input_str]
2025-05-15 12:30:24 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in <listcomp>
2025-05-15 12:30:24 | ERROR | stderr |     value = [self.infer_fn(s).tolist() for s in input_str]
2025-05-15 12:30:24 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:30:24 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:30:24 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/prm/infer_fns.py", line 11, in _qwen_math_infer_fn
2025-05-15 12:30:24 | ERROR | stderr |     step_tag_id = torch.tensor([tokenizer.encode(f" {STEP_TAG}")], device=device) # 76325
2025-05-15 12:30:24 | ERROR | stderr | RuntimeError: CUDA error: device-side assert triggered
2025-05-15 12:30:24 | ERROR | stderr | CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
2025-05-15 12:30:24 | ERROR | stderr | For debugging consider passing CUDA_LAUNCH_BLOCKING=1
2025-05-15 12:30:24 | ERROR | stderr | Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
2025-05-15 12:30:24 | ERROR | stderr | 
2025-05-15 12:31:46 | INFO | stdout | [32mINFO[0m:     127.0.0.1:53360 - "[1mPOST /worker_value_inference HTTP/1.1[0m" [91m500 Internal Server Error[0m
2025-05-15 12:31:46 | ERROR | stderr | [31mERROR[0m:    Exception in ASGI application
2025-05-15 12:31:46 | ERROR | stderr | Traceback (most recent call last):
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
2025-05-15 12:31:46 | ERROR | stderr |     result = await app(  # type: ignore[func-returns-value]
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     return await self.app(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     await super().__call__(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     raise exc
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     await self.app(scope, receive, _send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:31:46 | ERROR | stderr |     raise exc
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:31:46 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
2025-05-15 12:31:46 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
2025-05-15 12:31:46 | ERROR | stderr |     await route.handle(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
2025-05-15 12:31:46 | ERROR | stderr |     await self.app(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
2025-05-15 12:31:46 | ERROR | stderr |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:31:46 | ERROR | stderr |     raise exc
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:31:46 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
2025-05-15 12:31:46 | ERROR | stderr |     response = await f(request)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
2025-05-15 12:31:46 | ERROR | stderr |     raw_response = await run_endpoint_function(
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
2025-05-15 12:31:46 | ERROR | stderr |     return await dependant.call(**values)
2025-05-15 12:31:46 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/base_model_worker.py", line 218, in value_inference
2025-05-15 12:31:46 | ERROR | stderr |     output = await asyncio.to_thread(worker.value_inference_gate, params)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/asyncio/threads.py", line 25, in to_thread
2025-05-15 12:31:46 | ERROR | stderr |     return await loop.run_in_executor(None, func_call)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/concurrent/futures/thread.py", line 58, in run
2025-05-15 12:31:46 | ERROR | stderr |     result = self.fn(*self.args, **self.kwargs)
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:31:46 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:31:46 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in value_inference_gate
2025-05-15 12:31:46 | ERROR | stderr |     # value = value_2
2025-05-15 12:31:46 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in <listcomp>
2025-05-15 12:31:46 | ERROR | stderr |     # value = value_2
2025-05-15 12:31:46 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:31:46 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:31:46 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/prm/infer_fns.py", line 11, in _qwen_math_infer_fn
2025-05-15 12:31:46 | ERROR | stderr |     step_tag_id = torch.tensor([tokenizer.encode(f" {STEP_TAG}")], device=device) # 76325
2025-05-15 12:31:46 | ERROR | stderr | RuntimeError: CUDA error: device-side assert triggered
2025-05-15 12:31:46 | ERROR | stderr | CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
2025-05-15 12:31:46 | ERROR | stderr | For debugging consider passing CUDA_LAUNCH_BLOCKING=1
2025-05-15 12:31:46 | ERROR | stderr | Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
2025-05-15 12:31:46 | ERROR | stderr | 
2025-05-15 12:31:49 | INFO | stdout | [32mINFO[0m:     127.0.0.1:53372 - "[1mPOST /worker_value_inference HTTP/1.1[0m" [91m500 Internal Server Error[0m
2025-05-15 12:31:49 | ERROR | stderr | [31mERROR[0m:    Exception in ASGI application
2025-05-15 12:31:49 | ERROR | stderr | Traceback (most recent call last):
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
2025-05-15 12:31:49 | ERROR | stderr |     result = await app(  # type: ignore[func-returns-value]
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     return await self.app(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     await super().__call__(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/applications.py", line 112, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 187, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     raise exc
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/errors.py", line 165, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     await self.app(scope, receive, _send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:31:49 | ERROR | stderr |     raise exc
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:31:49 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 714, in __call__
2025-05-15 12:31:49 | ERROR | stderr |     await self.middleware_stack(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 734, in app
2025-05-15 12:31:49 | ERROR | stderr |     await route.handle(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 288, in handle
2025-05-15 12:31:49 | ERROR | stderr |     await self.app(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 76, in app
2025-05-15 12:31:49 | ERROR | stderr |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
2025-05-15 12:31:49 | ERROR | stderr |     raise exc
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
2025-05-15 12:31:49 | ERROR | stderr |     await app(scope, receive, sender)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/starlette/routing.py", line 73, in app
2025-05-15 12:31:49 | ERROR | stderr |     response = await f(request)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 301, in app
2025-05-15 12:31:49 | ERROR | stderr |     raw_response = await run_endpoint_function(
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
2025-05-15 12:31:49 | ERROR | stderr |     return await dependant.call(**values)
2025-05-15 12:31:49 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/base_model_worker.py", line 218, in value_inference
2025-05-15 12:31:49 | ERROR | stderr |     output = await asyncio.to_thread(worker.value_inference_gate, params)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/asyncio/threads.py", line 25, in to_thread
2025-05-15 12:31:49 | ERROR | stderr |     return await loop.run_in_executor(None, func_call)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/concurrent/futures/thread.py", line 58, in run
2025-05-15 12:31:49 | ERROR | stderr |     result = self.fn(*self.args, **self.kwargs)
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:31:49 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:31:49 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in value_inference_gate
2025-05-15 12:31:49 | ERROR | stderr |     # value = value_2
2025-05-15 12:31:49 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/reason/llm_service/workers/reward_model_worker.py", line 129, in <listcomp>
2025-05-15 12:31:49 | ERROR | stderr |     # value = value_2
2025-05-15 12:31:49 | ERROR | stderr |   File "/root/miniconda3/envs/open_reasoner/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
2025-05-15 12:31:49 | ERROR | stderr |     return func(*args, **kwargs)
2025-05-15 12:31:49 | ERROR | stderr |   File "/fs-computility/mabasic/fanyuchen/openr/prm/infer_fns.py", line 11, in _qwen_math_infer_fn
2025-05-15 12:31:49 | ERROR | stderr |     step_tag_id = torch.tensor([tokenizer.encode(f" {STEP_TAG}")], device=device) # 76325
2025-05-15 12:31:49 | ERROR | stderr | RuntimeError: CUDA error: device-side assert triggered
2025-05-15 12:31:49 | ERROR | stderr | CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
2025-05-15 12:31:49 | ERROR | stderr | For debugging consider passing CUDA_LAUNCH_BLOCKING=1
2025-05-15 12:31:49 | ERROR | stderr | Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.
2025-05-15 12:31:49 | ERROR | stderr | 
2025-05-15 12:31:56 | ERROR | stderr | [32mINFO[0m:     Shutting down
2025-05-15 12:31:56 | ERROR | stderr | [32mINFO[0m:     Waiting for application shutdown.
2025-05-15 12:31:56 | ERROR | stderr | [32mINFO[0m:     Application shutdown complete.
2025-05-15 12:31:56 | ERROR | stderr | [32mINFO[0m:     Finished server process [[36m719628[0m]
